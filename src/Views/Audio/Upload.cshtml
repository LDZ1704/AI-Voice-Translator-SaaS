@{
    ViewData["Title"] = "Tải lên âm thanh";
}

<div class="container mt-5">
    <div class="row justify-content-center fade-in">
        <div class="col-lg-8">
            @if (ViewBag.RemainingConversions != null)
            {
                <div class="alert @(ViewBag.RemainingConversions <= 5 ? "alert-warning" : "alert-info") mb-4">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <i class="fas fa-chart-line me-2"></i>
                            <strong>Gói hiện tại:</strong> @ViewBag.PlanName | 
                            <strong>Đã dùng:</strong> @ViewBag.UsedConversions / @ViewBag.TotalConversions lượt |
                            <strong>Còn lại:</strong> <span class="fw-bold">@ViewBag.RemainingConversions lượt</span>
                        </div>
                        @if (ViewBag.RemainingConversions <= 5)
                        {
                            <a asp-controller="Billing" asp-action="Index" class="btn btn-sm btn-warning">
                                <i class="fas fa-arrow-up me-1"></i> Nâng cấp ngay
                            </a>
                        }
                    </div>
                    @if (ViewBag.IsExpired == true)
                    {
                        <div class="mt-2">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong class="text-danger">Gói của bạn đã hết hạn. Vui lòng gia hạn để tiếp tục sử dụng.</strong>
                            <a asp-controller="Billing" asp-action="Index" class="btn btn-sm btn-danger ms-2">Gia hạn ngay</a>
                        </div>
                    }
                </div>
            }

            <div class="card shadow-custom">
                <div class="card-header text-center py-4">
                    <h3 class="mb-0">
                        <i class="bi bi-cloud-upload-fill"></i> Tải lên file âm thanh
                    </h3>
                    <p class="text-white-50 mb-0 mt-2">Hỗ trợ: MP3, WAV, M4A (tối đa 20MB)</p>
                </div>
                <div class="card-body p-5">
                    <div id="dropZone" class="border border-3 border-dashed rounded-3 p-5 text-center mb-4"
                         style="border-color: var(--blue-primary) !important; background: var(--blue-light); cursor: pointer;">
                        <i class="bi bi-cloud-arrow-up display-1 text-primary"></i>
                        <h5 class="mt-3">Kéo thả file vào đây</h5>
                        <p class="text-muted">hoặc</p>
                        <label for="audioFile" class="btn btn-primary btn-lg">
                            <i class="bi bi-folder2-open"></i> Chọn file
                        </label>
                        <input type="file" id="audioFile" name="audioFile" accept=".mp3,.wav,.m4a" hidden>
                    </div>

                    <div id="filePreview" class="d-none">
                        <div class="card bg-light">
                            <div class="card-body">
                                <div class="d-flex align-items-center">
                                    <i class="bi bi-file-earmark-music-fill text-primary fs-1 me-3"></i>
                                    <div class="flex-grow-1">
                                        <h6 id="fileName" class="mb-1"></h6>
                                        <small id="fileSize" class="text-muted"></small>
                                    </div>
                                    <button type="button" class="btn btn-danger btn-sm" id="removeFile">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4">
                            <label class="form-label">Ngôn ngữ nguồn</label>
                            <select class="form-select" id="sourceLanguage">
                                <option value="en">English</option>
                                <option value="vi" selected>Tiếng Việt</option>
                                <option value="ja">日本語 (Japanese)</option>
                            </select>
                        </div>

                        <div class="mt-3">
                            <label class="form-label">Ngôn ngữ đích</label>
                            <select class="form-select" id="targetLanguage">
                                <option value="en" selected>English</option>
                                <option value="vi">Tiếng Việt</option>
                                <option value="ja">日本語 (Japanese)</option>
                            </select>
                        </div>

                        <div id="progressContainer" class="mt-4 d-none">
                            <div class="progress" style="height: 25px;">
                                <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated bg-primary"
                                     role="progressbar" style="width: 0%"></div>
                            </div>
                            <p id="progressText" class="text-center mt-2 text-muted"></p>
                        </div>

                        <div class="d-grid gap-2 mt-4">
                            <button type="button" class="btn btn-success btn-lg" id="uploadBtn">
                                <i class="bi bi-upload"></i> Bắt đầu xử lý
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-md-4">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="bi bi-lightning-charge-fill text-warning fs-1"></i>
                            <h6 class="mt-2">Xử lý nhanh</h6>
                            <small class="text-muted">&lt; 60 giây</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="bi bi-shield-check text-success fs-1"></i>
                            <h6 class="mt-2">Bảo mật</h6>
                            <small class="text-muted">Dữ liệu được mã hóa</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="bi bi-stars text-primary fs-1"></i>
                            <h6 class="mt-2">Translator API</h6>
                            <small class="text-muted">Microsoft Azure Translator API</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">